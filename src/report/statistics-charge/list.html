<template>
  <div class="page-title">
    <h3>收费统计</h3>
  </div>
  <div class="row">
    <div class="col-md-6 col-md-offset-6">
      <div class="input-group left">
        <input
            ak-datepicker="k-value.two-way: yearStatistic; k-start.bind:'decade'; k-depth.bind: 'decade';k-format.bind:'yyyy';"/>
        <input
            ak-datepicker="k-value.two-way: monthStatistic; k-start.bind:'year'; k-depth.bind: 'year';k-format.bind:'MMMM';"/>
      </div>
      <div class="input-group left">
        <ak-drop-down-list k-value.two-way="criteria.dateType" k-data-text-field="text" k-data-value-field="value"
                           k-data-source.bind="dateType">
        </ak-drop-down-list>
      </div>
      <div class="input-group left">
        <ak-drop-down-list k-value.two-way="criteria.customerName" k-option-label="请选择客户" k-data-text-field="value"
                           k-data-value-field="value" k-data-source.bind="customers">
        </ak-drop-down-list>
      </div>
      <div class="input-group left">
      </div>
      <div class="input-group left" if.bind="type == 2">
        <ak-drop-down-list k-value.two-way="criteria.billingTypeStr" k-data-text-field="text"
                           k-data-value-field="value"
                           k-option-label="请选择开票状态...(默认全部)"
                           k-data-source.bind="billingTypeStr">
        </ak-drop-down-list>
      </div>
      <div class="input-group left m-l-5">
        <input type="text" value.bind="criteria.cargoCategoryName" placeholder="请输入货类">
      </div>
      <div class="input-group left">
        <div class="input-group-addon search" click.delegate="select()"><em class="fa fa-search"></em></div>
        <div class="input-group-addon search" click.delegate="reset()" title="重置"><em class="fa fa-rotate-left"></em>
          <button class="btn btn-small" click.delegate="print()">打印</button>
        </div>
      </div>
    </div>
  </div>
  <div if.bind="type == 1">
    <ak-grid k-data-source.bind="dataSource" k-sortable.bind="true" k-reorderable.bind="true" k-resizable.bind="true"
             k-pageable.bind="pageable">
      <ak-col k-field="date" k-title="日期" k-format='{0:yyyy-MM-dd}'></ak-col>
      <ak-col k-field="type" k-title="type"></ak-col>
      <ak-col k-field="customerName" k-title="客户名称"></ak-col>
      <ak-col k-field="cargoCategoryName" k-title="货类"></ak-col>
      <ak-col k-field="warehousingAmount" k-title="仓储费"></ak-col>
      <ak-col k-field="loadingAmount" k-title="装卸费"></ak-col>
      <ak-col k-field="otherAmount" k-title="其他费用"></ak-col>
      <ak-col k-field="sumAmount" k-title="费用合计"></ak-col>
      <ak-col k-field="remark" k-title="备注"></ak-col>
    </ak-grid>
  </div>
  <div if.bind="type == 2">
    <ak-grid k-data-source.bind="dataSource" k-sortable.bind="true" k-reorderable.bind="true" k-resizable.bind="true"
             k-pageable.bind="pageable">
      <ak-col k-field="month" k-title="日期"></ak-col>
      <ak-col k-field="type" k-title="type"></ak-col>
      <ak-col k-field="customerName" k-title="客户名称"></ak-col>
      <ak-col k-field="cargoCategoryName" k-title="货类"></ak-col>
      <ak-col k-field="warehousingAmount" k-title="仓储费"></ak-col>
      <ak-col k-field="loadingAmount" k-title="装卸费"></ak-col>
      <ak-col k-field="otherAmount" k-title="其他费用"></ak-col>
      <ak-col k-field="sumAmount" k-title="费用合计"></ak-col>
      <ak-col k-field="billingType == 1?'已开票':'未开票'" k-title="开票状态"></ak-col>
      <ak-col k-field="monthCharge" k-title="本月收费"></ak-col>
      <ak-col k-field="monthArrears" k-title="本月欠费"></ak-col>
      <ak-col k-field="remark" k-title="备注"></ak-col>
    </ak-grid>
  </div>
  <div if.bind="type == 3">
    <ak-grid k-data-source.bind="dataSource" k-sortable.bind="true" k-reorderable.bind="true" k-resizable.bind="true"
             k-pageable.bind="pageable">
      <ak-col k-field="month" k-title="日期"></ak-col>
      <ak-col k-field="type" k-title="type"></ak-col>
      <ak-col k-field="warehousingAmount" k-title="仓储费"></ak-col>
      <ak-col k-field="loadingAmount" k-title="装卸费"></ak-col>
      <ak-col k-field="otherAmount" k-title="其他费用"></ak-col>
      <ak-col k-field="sumAmount" k-title="费用合计"></ak-col>
      <ak-col k-field="monthCharge" k-title="本月收费"></ak-col>
      <ak-col k-field="monthArrears" k-title="本月欠费"></ak-col>
      <ak-col k-field="grandTotalCharge" k-title="收费累计"></ak-col>
      <ak-col k-field="grandTotalArrears" k-title="欠费累计"></ak-col>
      <ak-col k-field="grandTotalAmount" k-title="费用累计"></ak-col>
      <ak-col k-field="remark" k-title="备注"></ak-col>
    </ak-grid>
  </div>

  <div >
    <div class="col-md-12 col-md-offset-2" id="week">
      <table border="1" style="width:99%;max-width:900px;border-collapse:collapse;">
        <tr>
          <td align="center" colspan="8">
            <!--客户 货类-->
            <h4>${criteria.customerName}&nbsp;&nbsp;${criteria.cargoCategoryName}本周收费统计</h4>
          </td>
        </tr>

        <tr>
          <td align="center" colspan="8">收费统计明细</td>
        </tr>
        <tr>
          <td align="center">日期</td>
          <td align="center">客户名称</td>
          <td align="center">货类</td>
          <td align="center">仓储费</td>
          <td align="center">装卸费</td>
          <td align="center">其他费用</td>
          <td align="center">合计</td>
          <td align="center">备注</td>
        </tr>
        <template repeat.for="statisticsCharge of statisticsCharges">
          <tr>
            <td align="center">${statisticsCharge.dateStr}</td>
            <td align="center">${statisticsCharge.customerName}</td>
            <td align="center">${statisticsCharge.cargoCategoryName}</td>
            <td align="center">${statisticsCharge.warehousingAmount}</td>
            <td align="center">${statisticsCharge.loadingAmount}</td>
            <td align="center">${statisticsCharge.otherAmount}</td>
            <td align="center">${statisticsCharge.sumAmount}</td>
            <td align="center">${statisticsCharge.remark}</td>
          </tr>
        </template>
        <tr>
          <td align="center">备注</td>
          <td colspan="7">${termStatistics.remark}</td>
        </tr>
      </table>
    </div>

    <div class="col-md-12 col-md-offset-2" id="month">
      <table border="1" style="width:99%;max-width:900px;border-collapse:collapse;">
        <tr>
          <td align="center" colspan="6">
            <!--客户 货类 月份-->
            <h4>${criteria.customerName}&nbsp;&nbsp;${criteria.cargoCategoryName}&nbsp;&nbsp;${criteria.yearMonth}收费统计</h4>
          </td>
        </tr>
        <tr>
          <td align="center">当月仓储费:</td>
          <td>${monthlyStatistics.warehousingAmount}</td>
          <td align="center">当月装卸费:</td>
          <td>${monthlyStatistics.loadingAmount}</td>
          <td align="center">当月其他费用:</td>
          <td>${monthlyStatistics.otherAmount}</td>
        </tr>
        <tr>
          <td align="center">当月费用合计:</td>
          <td>${monthlyStatistics.sumAmount}</td>
          <td align="center">当月收费:</td>
          <td>${monthlyStatistics.monthCharge}</td>
          <td align="center">当月欠费:</td>
          <td>${monthlyStatistics.monthArrears}</td>
        </tr>
        <tr>
          <td align="center" colspan="6">收费统计明细</td>
        </tr>
        <tr if.bind="warehouseStatistics.length > 0">
          <td align="center">客户名称</td>
          <td align="center" colspan="2">货类</td>
          <td align="center" colspan="2">仓储费</td>
          <td align="center">开票状态</td>
        </tr>
        <template repeat.for="statisticsCharge of warehouseStatistics">
          <tr if.bind="statisticsCharge.warehousingAmount">
            <td align="center">${statisticsCharge.customerName}</td>
            <td align="center" colspan="2">${statisticsCharge.cargoCategoryName}</td>
            <td align="center" colspan="2">${statisticsCharge.warehousingAmount}</td>
            <td align="center">${statisticsCharge.billingTypeStr}</td>
          </tr>
        </template>
        <tr if.bind="loadingStatistics.length > 0">
          <td align="center">客户名称</td>
          <td align="center" colspan="2">货类</td>
          <td align="center" colspan="2">装卸费</td>
          <td align="center">开票状态</td>
        </tr>
        <template repeat.for="statisticsCharge of loadingStatistics">
          <tr if.bind="statisticsCharge.loadingAmount">
            <td align="center">${statisticsCharge.customerName}</td>
            <td align="center" colspan="2">${statisticsCharge.cargoCategoryName}</td>
            <td align="center" colspan="2">${statisticsCharge.loadingAmount}</td>
            <td align="center">${statisticsCharge.billingTypeStr}</td>
          </tr>
        </template>
        <tr if.bind="otherStatistics.length > 0">
          <td align="center">客户名称</td>
          <td align="center" colspan="2">货类</td>
          <td align="center" colspan="2">其他费用</td>
          <td align="center">开票状态</td>
        </tr>
        <template repeat.for="statisticsCharge of otherStatistics">
          <tr if.bind="statisticsCharge.otherAmount">
            <td align="center">${statisticsCharge.customerName}</td>
            <td align="center" colspan="2">${statisticsCharge.cargoCategoryName}</td>
            <td align="center" colspan="2">${statisticsCharge.otherAmount}</td>
            <td align="center">${statisticsCharge.billingTypeStr}</td>
          </tr>
        </template>
        <tr>
          <td align="center">备注</td>
          <td colspan="5">${termStatistics.remark}</td>
        </tr>
      </table>
    </div>

    <div class="col-md-12 col-md-offset-2" id="year">
      <table border="1" style="width:99%;max-width:900px;border-collapse:collapse;">
        <tr>
          <td align="center" colspan="13">
            <!--客户 货类 年-->
            <h4>${criteria.customerName}&nbsp;&nbsp;${criteria.cargoCategoryName}&nbsp;&nbsp;${criteria.yearMonth}收费统计</h4>
          </td>
        </tr>
        <tr>
          <td align="center">当年仓储费:</td>
          <td>${termStatistics.warehousingAmount}</td>
          <td align="center">当年装卸费:</td>
          <td>${termStatistics.loadingAmount}</td>
          <td align="center">当年其他费用:</td>
          <td>${termStatistics.otherAmount}</td>
          <td align="center">当年收费:</td>
          <td>${termStatistics.monthCharge}</td>
          <td align="center">当年欠费:</td>
          <td>${termStatistics.monthArrears}</td>
          <td align="center">当年费用合计:</td>
          <td colspan="2">${termStatistics.sumAmount}</td>
        </tr>
        <tr>
          <td align="center">收费累计:</td>
          <td>${termStatistics.grandTotalCharge}</td>
          <td align="center">欠费累计:</td>
          <td>${termStatistics.grandTotalArrears}</td>
          <td align="center">费用累计:</td>
          <td colspan="8">${termStatistics.grandTotalAmount}</td>
        </tr>
        <tr>
          <td align="center">备注</td>
          <td colspan="12">${termStatistics.remark}</td>
        </tr>
        <tr>
          <td align="center" colspan="13">收费统计明细</td>
        </tr>
        <tr>
          <td align="center">月份</td>
          <td align="center">客户名称</td>
          <td align="center">货类</td>
          <td align="center">仓储费</td>
          <td align="center">装卸费</td>
          <td align="center">其他费用</td>
          <td align="center">费用合计</td>
          <td align="center">本月收费</td>
          <td align="center">本月欠费</td>
          <td align="center">收费累计</td>
          <td align="center">欠费累计</td>
          <td align="center">费用累计</td>
          <td align="center">备注</td>
        </tr>
        <template repeat.for="statisticsCharge of statisticalDetails">
          <tr>
            <td align="center">${statisticsCharge.month}</td>
            <td align="center">${statisticsCharge.customerName}</td>
            <td align="center">${statisticsCharge.cargoCategoryName}</td>
            <td align="center">${statisticsCharge.warehousingAmount}</td>
            <td align="center">${statisticsCharge.loadingAmount}</td>
            <td align="center">${statisticsCharge.otherAmount}</td>
            <td align="center">${statisticsCharge.sumAmount}</td>
            <td align="center">${statisticsCharge.monthCharge}</td>
            <td align="center">${statisticsCharge.monthArrears}</td>
            <td align="center">${statisticsCharge.grandTotalCharge}</td>
            <td align="center">${statisticsCharge.grandTotalArrears}</td>
            <td align="center">${statisticsCharge.grandTotalAmount}</td>
            <td align="center">${statisticsCharge.remark}</td>
          </tr>
        </template>
      </table>
    </div>
  </div>
</template>
