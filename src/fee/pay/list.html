<template>
  <div class="row">
    <div class="col-md-9">
      <a class="btn btn-small btn-success" click.delegate="add()">新增结算需求</a>
      <button class="btn btn-small" click.delegate="verifyHistory()">审核记录</button>
    </div>
      <div class="input-group"><input class="form-control" type="text" value.bind="keyword" placeholder="请输入客户名称">
        <div class="input-group-addon" click.delegate="select()"><em class="fa fa-search"></em></div>
      </div>
    </div>
    <ak-grid k-data-source.bind="dataSource" k-sortable.bind="true" k-pageable.bind="pageable" k-selectable="row"
             k-on-change.delegate="rowSelected($event.detail)">
      <ak-col k-field="customerName" k-title="客户名称">
        <ak-template>
          <!-- <a route-href="route: view; params.bind: { id: id }">${customerName}</a> -->
          ${customerName}
        </ak-template>
      </ak-col>
      <ak-col k-field="typeTitle" k-title="结算生成方式"></ak-col>
      <ak-col k-field="chargeStartDate" k-title="结算开始日期" k-format="{0:yyyy-MM-dd HH:mm:ss}"></ak-col>
      <ak-col k-field="chargeEndDate" k-title="结算结束日期" k-format="{0:yyyy-MM-dd HH:mm:ss}"></ak-col>
      <ak-col k-field="stageTitle" k-title="阶段"></ak-col>
      <ak-col k-field="remark" k-title="备注"></ak-col>
      <ak-col k-title="操作">
        <ak-template>
          <a class="btn btn-primary btn-small" route-href="route: details; params.bind: { id: id }">清单</a>
          <a if.bind='stage == 1' class="btn btn-primary btn-small" click.delegate="edit(id)">编辑</a>
          <a class="btn btn-small" if.bind="stage==1" route-href="route: confirm; params.bind: {id: id}">装卸单位确认</a>
          <a class="btn btn-small" if.bind="stage==3" route-href="route: verify; params.bind: {id: id}">费收审核</a>
          <a class="btn btn-small" if.bind="stage==5"
             route-href="route: note; params.bind: {id: id, status: 1}">生成付费单</a>
          <a class="btn btn-small" if.bind="stage>=5" route-href="route: note; params.bind: {id: id}">查看付费单</a>
          <button class="btn btn-small" if.bind="stage==6" click.delegate="leaderVerify(id)">领导签字审核</button>
          <button class="btn btn-small" if.bind="stage==7" click.delegate="invoice(id)">录入发票号</button>
          <button class="btn btn-small" if.bind="stage==8" click.delegate="verifyPay(id)">付费核销</button>
        </ak-template>
      </ak-col>
    </ak-grid>
  </div>
</template>